trigger:
  branches:
    include:
      - main

pool: 'Croem Build Servers'

stages:

# ============================
# üß™ Stage: Run Cypress Tests
# ============================
- stage: Test
  displayName: "Run Cypress Tests"
  jobs:
    - job: CypressJob
      displayName: "Execute Cypress Tests"
      steps:

        # ---------------------------------
        # 1Ô∏è‚É£ Install Node.js
        # ---------------------------------
        - task: NodeTool@0
          inputs:
            versionSpec: '18.x'
          displayName: "Install Node.js"

        # ---------------------------------
        # 2Ô∏è‚É£ Install Dependencies
        # ---------------------------------
        - script: npm ci
          displayName: "Install NPM Dependencies"

        # ---------------------------------
        # 4Ô∏è‚É£ Run Cypress Tests (Headless Chrome)
        # ---------------------------------
        - script: npx cypress run --browser chrome
          displayName: "Run Cypress Tests"
